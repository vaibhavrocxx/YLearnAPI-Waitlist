<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Join the YLearn API Waitlist</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Slate 50 */
            background-image: 
                radial-gradient(at 0% 0%, rgba(56, 189, 248, 0.1) 0px, transparent 50%),
                radial-gradient(at 100% 0%, rgba(139, 92, 246, 0.1) 0px, transparent 50%);
            color: #0f172a; /* Slate 900 */
        }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.05);
        }

        /* Loading Spinner Animation */
        .loader {
            border: 3px solid rgba(255,255,255,0.3);
            border-left-color: #ffffff;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <main class="w-full max-w-md">
        <!-- Logo / Branding Area -->
        <div class="text-center mb-8 fade-in">
            <!-- 
                LOGO IMAGE
                Updated path: "logo.png" assumes the file is in the same folder as index.html
            -->
            <img 
                src="logo.png" 
                alt="Company Logo" 
                class="w-20 h-20 mx-auto rounded-2xl mb-4 shadow-lg shadow-sky-500/20 object-cover"
                onerror="this.src='https://placehold.co/150x150/0ea5e9/ffffff?text=Logo'"
            >
            
            <h1 class="text-3xl font-bold tracking-tight text-slate-900">YLearn API</h1>
            <p class="mt-2 text-slate-500">The next generation of learning intelligence.</p>
        </div>

        <!-- Card Container -->
        <div class="glass-panel rounded-2xl p-6 sm:p-8 fade-in" style="animation-delay: 0.1s;">
            
            <!-- FORM STATE -->
            <form id="waitlistForm" class="space-y-5">
                <div>
                    <label for="name" class="block text-sm font-medium text-slate-700 mb-1.5">Full Name</label>
                    <input type="text" id="name" name="name" required 
                        class="w-full px-4 py-3 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 text-slate-900 placeholder-slate-400 transition-all outline-none shadow-sm"
                        placeholder="Elon Musk">
                </div>

                <div>
                    <label for="email" class="block text-sm font-medium text-slate-700 mb-1.5">Email Address</label>
                    <input type="email" id="email" name="email" required 
                        class="w-full px-4 py-3 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 text-slate-900 placeholder-slate-400 transition-all outline-none shadow-sm"
                        placeholder="elon@spacex.com">
                </div>

                <button type="submit" id="submitBtn" 
                    class="w-full py-3.5 px-4 bg-gradient-to-r from-sky-600 to-indigo-600 hover:from-sky-500 hover:to-indigo-500 text-white font-semibold rounded-lg shadow-md shadow-sky-500/20 transition-all transform active:scale-[0.98] flex justify-center items-center gap-2">
                    <span>Join the Waitlist</span>
                </button>
                
                <p class="text-xs text-center text-slate-500 mt-4">
                    We respect your inbox. No spam, ever.
                </p>
            </form>

            <!-- SUCCESS STATE (Hidden by default) -->
            <div id="successMessage" class="hidden text-center py-4">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-slate-900 mb-2">You're on the list!</h3>
                <p class="text-slate-600 mb-6">We've sent a confirmation email to <span id="userEmailDisplay" class="text-sky-600 font-medium"></span>.</p>
            </div>

            <!-- ERROR STATE (Hidden by default) -->
            <div id="errorMessage" class="hidden mt-4 p-3 bg-red-50 border border-red-100 rounded-lg text-red-600 text-sm text-center break-words">
                Something went wrong. Please try again.
            </div>

        </div>
    </main>

    <script>
        // ==========================================
        // CONFIGURATION: REPLACE THESE VALUES
        // ==========================================
        
        const EMAILJS_PUBLIC_KEY = "aE_wcLQQrPmim1h9t"; 
        const EMAILJS_SERVICE_ID = "service_4jcudig"; 
        const EMAILJS_TEMPLATE_ID = "template_4j32ybq"; 

        // ==========================================
        // INITIALIZATION
        // ==========================================
        
        const isConfigured = EMAILJS_PUBLIC_KEY !== "YOUR_PUBLIC_KEY";

        if(isConfigured) {
            emailjs.init(EMAILJS_PUBLIC_KEY);
        } else {
            console.log("⚠️ EmailJS is not configured yet. Running in simulation mode.");
        }

        // ==========================================
        // LOGIC
        // ==========================================

        const form = document.getElementById('waitlistForm');
        const submitBtn = document.getElementById('submitBtn');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');
        const userEmailDisplay = document.getElementById('userEmailDisplay');

        // Check if user has already joined (LocalStorage)
        const checkExistingRegistration = () => {
            const hasJoined = localStorage.getItem('ylearn_waitlist_joined');
            const storedEmail = localStorage.getItem('ylearn_waitlist_email');

            if (hasJoined === 'true') {
                form.classList.add('hidden');
                if (storedEmail) {
                    userEmailDisplay.textContent = storedEmail;
                }
                successMessage.classList.remove('hidden');
            }
        };

        // Run check on load
        checkExistingRegistration();

        form.addEventListener('submit', function(event) {
            event.preventDefault();

            // UI: Set Loading State
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<div class="loader"></div>';
            errorMessage.classList.add('hidden');

            // Collect Data
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value
            };

            // Function to handle success UI
            const showSuccess = () => {
                form.classList.add('hidden');
                userEmailDisplay.textContent = formData.email;
                successMessage.classList.remove('hidden');
                successMessage.classList.add('fade-in');
                
                // Save to Local Storage
                localStorage.setItem('ylearn_waitlist_joined', 'true');
                localStorage.setItem('ylearn_waitlist_email', formData.email);
            };

            // Function to handle error UI
            const showError = (errorText, isConfigError) => {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnText;
                
                if (isConfigError) {
                     errorMessage.innerHTML = `<strong>Setup Required:</strong><br>${errorText}`;
                } else {
                     errorMessage.innerHTML = errorText;
                }
                errorMessage.classList.remove('hidden');
            };

            // SEND EMAIL
            if (isConfigured) {
                // Real Email Sending
                emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, {
                    to_name: formData.name,
                    to_email: formData.email, // This MUST match the "To Email" field in your template settings as {{to_email}}
                    reply_to: formData.email
                })
                .then(function() {
                    showSuccess();
                }, function(error) {
                    console.error('FAILED...', error);
                    
                    // SMART ERROR HANDLING
                    // This checks for the specific 422 error you saw in the console
                    if (error.text && error.text.includes("recipients address is empty")) {
                        showError("Go to EmailJS Dashboard -> Email Templates -> Settings.<br>Set 'To Email' to: <code>{{to_email}}</code>", true);
                    } else {
                        showError("Something went wrong. Please check your internet connection.", false);
                    }
                });
            } else {
                // Simulation Mode (for testing UI without keys)
                setTimeout(() => {
                    console.log(`[SIMULATION] Sending email to ${formData.email} for ${formData.name}`);
                    showSuccess();
                }, 1500);
            }
        });
    </script>
</body>
</html>
